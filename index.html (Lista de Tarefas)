<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Tarefas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .urgente {
            color: #dc3545 !important;
            font-weight: bold;
        }
        .badge-baixa { background-color: #198754; }
        .badge-normal { background-color: #ffc107; color: #000; }
        .badge-urgente { background-color: #dc3545; }
    </style>
</head>

<body class="bg-light">
<div class="container mt-5">
    <h1 class="text-center mb-4">üìã Lista de Tarefas</h1>
    
    <div class="d-flex justify-content-between mb-4">
        <div>
            <span class="badge badge-baixa me-2">Baixa</span>
            <span class="badge badge-normal me-2">Normal</span>
            <span class="badge badge-urgente">Urgente</span>
        </div>
        <a href="cadastro.html" class="btn btn-primary">‚ûï Nova Tarefa</a>
    </div>

    <div class="card shadow">
        <div class="card-body">
            <div id="mensagem-vazia" class="text-center py-5" style="display: none;">
                <h4 class="text-muted">üì≠ Nenhuma tarefa cadastrada</h4>
                <p class="text-muted">Clique em "Nova Tarefa" para come√ßar</p>
            </div>
            
            <table class="table table-hover" id="tabela-tarefas" style="display: none;">
                <thead class="table-dark">
                    <tr>
                        <th width="15%">Prioridade</th>
                        <th width="25%">Descri√ß√£o</th>
                        <th width="15%">Local</th>
                        <th width="20%">Recursos Necess√°rios</th>
                        <th width="15%">Data Limite</th>
                        <th width="10%">Matr√≠cula</th>
                    </tr>
                </thead>
                <tbody id="corpo-tabela">
                    <!-- Tarefas ser√£o inseridas aqui via JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Fun√ß√£o para formatar data
    function formatarData(dataString) {
        if (!dataString) return '';
        const data = new Date(dataString);
        return data.toLocaleDateString('pt-BR') + ' ' + data.toLocaleTimeString('pt-BR', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
    }

    // Fun√ß√£o para obter cor da badge baseada na prioridade
    function getClassePrioridade(prioridade) {
        switch(prioridade) {
            case 'Baixa': return 'badge-baixa';
            case 'Normal': return 'badge-normal';
            case 'Urgente': return 'badge-urgente';
            default: return 'badge-secondary';
        }
    }

    // Fun√ß√£o para carregar e exibir tarefas
    function carregarTarefas() {
        const tarefas = JSON.parse(localStorage.getItem('tarefas')) || [];
        const corpoTabela = document.getElementById('corpo-tabela');
        const tabela = document.getElementById('tabela-tarefas');
        const mensagemVazia = document.getElementById('mensagem-vazia');
        
        // Limpar tabela
        corpoTabela.innerHTML = '';
        
        // Verificar se h√° tarefas
        if (tarefas.length === 0) {
            tabela.style.display = 'none';
            mensagemVazia.style.display = 'block';
            return;
        }
        
        // Mostrar tabela e esconder mensagem
        tabela.style.display = 'table';
        mensagemVazia.style.display = 'none';
        
        // Ordenar tarefas: Urgente primeiro, depois Normal, depois Baixa
        tarefas.sort((a, b) => {
            const ordem = { 'Urgente': 1, 'Normal': 2, 'Baixa': 3 };
            return ordem[a.prioridade] - ordem[b.prioridade];
        });
        
        // Adicionar cada tarefa na tabela
        tarefas.forEach(tarefa => {
            const tr = document.createElement('tr');
            
            // Aplicar classe urgente se necess√°rio
            if (tarefa.prioridade === 'Urgente') {
                tr.classList.add('urgente');
            }
            
            // Formatar recursos
            const recursosFormatados = Array.isArray(tarefa.recursosNecessarios) 
                ? tarefa.recursosNecessarios.join(', ')
                : tarefa.recursosNecessarios || '';
            
            tr.innerHTML = `
                <td>
                    <span class="badge ${getClassePrioridade(tarefa.prioridade)}">
                        ${tarefa.prioridade}
                    </span>
                </td>
                <td>${tarefa.descricao || ''}</td>
                <td>${tarefa.local || ''}</td>
                <td>
                    <small>${recursosFormatados}</small>
                </td>
                <td>
                    <small class="text-muted">${formatarData(tarefa.dataLimite)}</small>
                </td>
                <td>${tarefa.matricula || ''}</td>
            `;
            
            corpoTabela.appendChild(tr);
        });
    }

    // Carregar tarefas quando a p√°gina carregar
    document.addEventListener('DOMContentLoaded', carregarTarefas);
    
    // Adicionar exemplo pr√©-cadastrado se n√£o houver tarefas
    window.onload = function() {
        const tarefas = JSON.parse(localStorage.getItem('tarefas')) || [];
        if (tarefas.length === 0) {
            const exemplo = {
                prioridade: 'Urgente',
                descricao: 'Entregar trabalho final DWI',
                local: 'IFC',
                recursosNecessarios: ['Computador', 'Internet', 'Exemplos das aulas anteriores'],
                dataLimite: '2025-12-03 00:00:00',
                matricula: '3030303'
            };
            localStorage.setItem('tarefas', JSON.stringify([exemplo]));
            carregarTarefas();
        }
    };
</script>
</body>
</html>
